/*

Hello shareholders,

Welcome to my Github repository about SQL. Here shareholders that view my Github account can see my queries pulling
data from SQL relational databases. 

*/

-- 01. Can you show your shareholders all data from one of the tables in Analytics_Job_Market database?

SELECT 
    *
FROM Analytics_Job_Market.Job_Boards;

-- 02. Job Seekers are wondering what's the average salary per job title across the USA. Please round the result to the nearest 2 decimal places. Order by highest to lowest salary. Also add an alias after salary.

SELECT 
    job_title, 
    ROUND(AVG(salary), 2) AS Average_US_Analytics_Job_Salary
FROM Job_Boards
GROUP BY job_title
ORDER BY AVG(salary) DESC;

-- 03. "CHALLENGE" Can you show job seekers which data visualization tool is more pupular with employers? Tableau or Power BI? Find the difference in percentage of total. 

SELECT 
    (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards
        WHERE
            data_visualization = 'Power BI') / (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards) * 100.0 AS 'Power BI',
    (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards
        WHERE
            data_visualization = 'Tableau') / (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards) * 100.0 AS 'Tableau';

-- 04. Can you query job title and salary that is equal or greater than $80,000? Can you also add an aggregate functions and filter by job titles that has more than twenty counts? Some job seekers only wants the highest paying salary with the most job title counts.

SELECT 
    Job_title, 
    COUNT(Job_title)
FROM job_boards
WHERE salary >= 80000
GROUP BY Job_title
HAVING COUNT(Job_title) > 20;

-- 05. "CHALLENGE" Your manager would like to see all data within a database. Can you join two or more tables together?

SELECT 
    *
FROM Job_Boards AS JB
JOIN Job_Applications AS JA ON JB.Job_ID = JA.Job_ID
JOIN Job_Seekers AS JS ON JA.Job_Applicant_ID = JS.Job_Applicant_ID;

-- 06. The hiring manager interested in three unique industries. Select any three random industry showing all data.

SELECT 
    *
FROM job_boards
WHERE industry IN ('Staffing and Recruiting' , 'Financial Services', 'Education');

-- 07. Are you able to query the top five states that has the most job listings? Job seekers would like to know which state is best to find analytics jobs.

SELECT 
    state, 
    COUNT(state)
FROM
    job_boards
GROUP BY state
ORDER BY COUNT(state) DESC
LIMIT 5;

-- 08. "CHALLENGE" Can you write a query to find job candidates that does NOT have SQL, Tableau, and Python skills? The employeer must eliminate job seekers who does not meet the required experience! 

SELECT
	Job_Applicant_ID,
	First_Name,
    Last_Name,
    SQL_,
    Tableau,
    Python
FROM Job_Seekers
WHERE NOT (SQL_ = "YES") and NOT (Tableau = "YES") and NOT (Python = "YES");
-- Alternate Query
SELECT
	Job_Applicant_ID,
	First_Name,
    Last_Name,
    SQL_,
    Tableau,
    Python
FROM Job_Seekers
WHERE NOT SQL_ IN ("YES") and NOT Tableau IN ("YES") and NOT Python IN ("YES");

-- 09. What clause allows SQL to result in one unique value? HR would like a list of every unique employer.

SELECT
	DISTINCT Employer
FROM Job_Boards;

-- 10. How can you check the data types of each column in a table? 

DESCRIBE Job_Boards;
DESCRIBE Job_Seekers;
DESCRIBE Job_Applications;

-- 11. "CHALLENGE"
-- 12. Which job candidates has 4th to 10th most experience points? HR wants people who has experience but not too much experience.

SELECT
	First_Name,
	Last_Name,
    EX
FROM Job_Seekers
ORDER BY EX DESC
Limit 7
OFFSET 3;

-- 13. How can you find duplicate datas? Job Seekers are wondering how many employers has more than one analytics job opening.

SELECT
	Employer,
	COUNT(Employer)
FROM Job_Boards
GROUP BY Employer
HAVING COUNT(Employer) > 1; 

-- 14. "CHALLENGE" How can HR know which job seeker has applied more than one job application? The company and hiring manager would like to know which candiate is serious with the organization.

SELECT 
    Job_Applicant_ID, 
    First_name, 
    Last_Name
FROM Job_Seekers
WHERE Job_Applicant_ID IN (SELECT 
								Job_Applicant_ID
							FROM Job_Applications
							GROUP BY Job_Applicant_ID
							HAVING COUNT(Job_Applicant_ID) > 1);

-- 15. Can you count the number of job listings that is less or equal than ANY of the 60000 salary job listings? There are job seekers who are wondering how many jobs only pays 60000 or less.

SELECT 
    COUNT(*)
FROM Job_Boards
WHERE SALARY <= ANY (SELECT 
						Salary
					FROM Job_Boards
					WHERE Salary <= 60000);

-- 16. Which job seekers has submitted a job application and has been accpeted? Who is moving on in the interview process? Who is likely to be hired on? Who was the most EX? Please don't use a join.

SELECT
	Job_Applicant_ID,
	First_name,
	Last_Name,
	EX
FROM Job_Seekers
WHERE Job_Applicant_ID IN (SELECT
								Job_Applicant_ID
							FROM Job_Applications
                            WHERE Application_Status = "Accepted")
ORDER BY EX DESC;

-- 17. How can you help HR know which application_Status is being allowed "Under consideration" and "Status denied"? Both employer and employee must know who is moving on and who is not. 

SELECT 
	Job_ID,
	Job_Applicant_ID,
	Application_Status,
	IF(Application_Status = "Accepted", "Under Consideration", "Status denied") AS Job_Update
FROM Job_Applications;

-- 18. "CHALLENGE"
-- 19. "CHALLENGE"
-- 20. "CHALLENGE"
-- 21. How can you tell which Industry has competitive pay on the job market? Aspiring young shareholders wish to know which industry pay is low, mid, or excellent.

SELECT
	Industry,
	Salary,
	CASE
		WHEN Salary <= 60000 THEN "Low Pay"
		WHEN Salary >= 80000 THEN "Excellent Pay"
		Else "Mid Pay"
	END AS "Competitive pay"
From Job_Boards;
-- Alternate Query
SELECT
	Industry,
	Salary,
	CASE
		WHEN Salary BETWEEN 00001 AND 60000 THEN "Low Pay"
		WHEN Salary BETWEEN 60001 AND 79999 THEN  "Mid Pay"
		WHEN Salary >= 80000 THEN "Excellent Pay"
	END AS "Competitive pay"
From Job_Boards;

-- 22. How can you break down job seeker's education level into years of education based on their degree? Employers wants to know how many years of school each job candidate went to.

SELECT
	Education_Level,
	CASE
		WHEN Education_Level = "Associate" THEN "2 Year Education"
		WHEN Education_Level = "Bachelor's" THEN "4 Year Education"
		WHEN Education_Level = "Master's" THEN "6 Year Education"
	END AS Years_of_School
FROM Job_Seekers;

-- 23. How can you combine multiple string values into a single column? Your manager needed a few columns fused together into one to make name tags for an upcoming interview event.

SELECT
	CONCAT(First_Name, " ", Last_Name) AS Full_Name
FROM Job_Seekers;

-- 24. "CHALLENGE" How much will the job title salary cost the employer per an hour, if the employee works 40 hours every week out of the year? Before taxes.

SELECT 
    Employer, 
    Job_Title, 
    (Salary) / (52) / (40) AS Hourly_Pay
FROM Job_Boards
ORDER BY Hourly_Pay DESC;

-- 25. What is the character count includes the blank spaces found inside any columns? One of the shareholders wants to know the length of when you combine columns.

SELECT
	CONCAT(First_Name, " ", Last_Name) AS Full_Name,
    LENGTH(CONCAT(First_Name, " ", Last_Name)) AS Character_Value_Count
FROM Job_Seekers;

-- 26. How can you find strings with curtrain characters? Your boss has requested a list of characters that ends with "'s" in the education level column along with first & last names.

SELECT
	First_Name,
	Last_Name,
	Education_Level
FROM Job_Seekers
WHERE Education_Level LIKE "%'S";

-- 27. "CHALLENGE"
-- 28. How can you replace specified character patterns with new characters patterns? A shareholder from the staffing and recruiting department has noticed an error in the industry column where "Financial Services" should be replaced with "Finance".

SELECT
	Industry,
    REPLACE(Industry, "Financial Services", "Finance") AS Industry
FROM Job_Boards;

-- 29. Which SQL database platform is most popular with employers? Job seekers are wondering which SQL platform they should learn to have the best chance of landing a data job.

SELECT
	SQL_Server,
    COUNT(SQL_Server)
FROM Job_Boards
GROUP BY SQL_Server
ORDER BY COUNT(SQL_Server) DESC;

-- 30. "CHALLENGE" How many job listing has remote, hybrid, or onsite? Provide percentages and count of jobs. Job seekers are wondering the working locations for analytics job market.

SELECT
	(SELECT 
            COUNT(remote)
        FROM
            job_boards
        WHERE
            remote = 'X') / (SELECT 
            COUNT(remote)
        FROM
            job_boards) * 100.0 AS 'remote',
		(SELECT 
            COUNT(hybrid)
        FROM
            job_boards
        WHERE
            hybrid = 'X') / (SELECT 
            COUNT(hybrid)
        FROM
            job_boards) * 100.0 AS 'hybrid',
		(SELECT 
            COUNT(onsite)
        FROM
            job_boards
        WHERE
            onsite = 'X') / (SELECT 
            COUNT(onsite)
        FROM
            job_boards) * 100.0 AS 'onsite'

UNION

SELECT
	(SELECT
		CEILING(COUNT(remote))
		FROM
			job_boards
		WHERE
			remote = 'X') AS 'remote',
	(SELECT
		CEILING(COUNT(hybrid))
		FROM
			job_boards
		WHERE
			hybrid = 'X') AS 'hybrid',
	(SELECT
		CEILING(COUNT(onsite))
		FROM
			job_boards
		WHERE
			onsite = 'X') AS 'onsite';
