/*

Hello shareholders,

Welcome to my Github repository about SQL. Here shareholders that view my Github account can see my queries pulling
data from SQL relational databases. 

*/

-- 01. Can you show your shareholders all data from one of the tables in Analytics_Job_Market database?

SELECT 
    *
FROM Analytics_Job_Market.Job_Boards;

-- 02. Job Seekers are wondering what's the average salary per job title across the USA. Please round the result to the nearest 2 decimal places. Order by highest to lowest salary. Also add an alias after salary.

SELECT 
    job_title, 
    ROUND(AVG(salary), 2) AS Average_US_Analytics_Job_Salary
FROM Job_Boards
GROUP BY job_title
ORDER BY AVG(salary) DESC;

-- 03. "CHALLENGE" Can you show job seekers which data visualization tool is more pupular with employers? Tableau or Power BI? Find the difference in percentage of total. 

SELECT 
    (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards
        WHERE
            data_visualization = 'Power BI') / (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards) * 100.0 AS 'Power BI',
    (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards
        WHERE
            data_visualization = 'Tableau') / (SELECT 
            COUNT(data_visualization)
        FROM
            job_boards) * 100.0 AS 'Tableau';

-- 04. Can you query job title and salary that is equal or greater than $80,000? Can you also add an aggregate functions and filter by job titles that has more than twenty counts? Some job seekers has a minimum salary expectation due to their bills.

SELECT 
    Job_title, 
    COUNT(Job_title)
FROM job_boards
WHERE salary >= 80000
GROUP BY Job_title
HAVING COUNT(Job_title) > 20;

-- 05. "CHALLENGE" Your manager would like to see all data within a database. Can you join two or more tables together?

SELECT 
    *
FROM Job_Boards AS JB
JOIN Job_Applications AS JA ON JB.Job_ID = JA.Job_ID
JOIN Job_Seekers AS JS ON JA.Job_Applicant_ID = JS.Job_Applicant_ID;

-- 06. The hiring manager interested in three unique industries. Select any three random industry showing all data.

SELECT 
    *
FROM job_boards
WHERE industry IN ('Staffing and Recruiting' , 'Financial Services', 'Education');

-- 07. Are you able to query the top five states that has the most job listings? Job seekers would like to know which state is best to find analytics jobs.

SELECT 
    state, 
    COUNT(state)
FROM
    job_boards
GROUP BY state
ORDER BY COUNT(state) DESC
LIMIT 5;

-- 08. "CHALLENGE" Can you write a query to find job candidates that does NOT have SQL, Tableau, and Python skills? The employeer must eliminate job seekers who does not meet the required experience! 

SELECT
	Job_Applicant_ID,
	First_Name,
    Last_Name
FROM Job_Seekers
WHERE NOT (SQL_ = "YES") and NOT (Tableau = "YES") and NOT (Python = "YES");
-- Alternate Query
SELECT
	Job_Applicant_ID,
	First_Name,
    Last_Name,
    SQL_,
    Tableau,
    Python
FROM Job_Seekers
WHERE NOT SQL_ IN ("YES") and NOT Tableau IN ("YES") and NOT Python IN ("YES");

-- 09. What clause allows SQL to result in one unique value? HR would like a list of every unique employer.

SELECT
DISTINCT Employer
FROM Job_Boards;

-- 10. How can you check the data types of each column in a table? 

DESCRIBE Job_Boards;
DESCRIBE Job_Seekers;
DESCRIBE Job_Applications;

-- 11. "CHALLENGE"



-- 12. Which job candidates has 4th to 10th most experience points? HR wants people who has experience but not too much experience.

SELECT
	First_Name,
	Last_Name,
    EX
FROM Job_Seekers
ORDER BY EX DESC
Limit 7
OFFSET 3;

-- 13. 
-- 14. "CHALLENGE"
-- 15. 
-- 16. 
-- 17. 
-- 18. "CHALLENGE"
-- 19. "CHALLENGE"
-- 20. "CHALLENGE"
-- 21. 
-- 22. 
-- 23. 
-- 24. "CHALLENGE"
-- 25. 
-- 26. 
-- 27. "CHALLENGE"
-- 28. 
-- 29. 
-- 30. "CHALLENGE"
